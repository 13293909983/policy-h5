<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>电子保函服务平台</title>
		<link rel="stylesheet" href="/static/css/common.css" />
		<link rel="stylesheet" href="/static/css/newconten.css" />
		<link rel="stylesheet" href="/static/css/newslist.css" />
		<link rel="stylesheet" href="/static/css/index.css" />
		<link rel="stylesheet" href="/static/css/paging.css" />
		<link rel="icon" type="image/x-icon" href="/static/favicon.ico">
		<script src="/static/js/jquery-1.9.1.min.js" type="text/javascript"></script>
		<script src="/static/js/index.js" type="text/javascript"></script>
		<script type="text/javascript" src="/static/js/paging.js"></script>
		<link rel="stylesheet" href="/static/layui/css/layui.css">
		<script src="/static/layui/layui.js"></script>
	</head>
	<body>
		<header></header>
		<div class="body_mian">
			<div class="title_wrap">
				<div class="title_nav">
					<h3>政策法规</h3><img src="/static/images/xz.png" />
				</div>

				<div class="news_lefts">
					<div class="news_lefttit">
						<div class="news_lefttitle news_lefttitlenow" data-code="1">政策法规</div>
						<div class="news_lefttitle" data-code="2">新闻热点</div>
						<hr class="certer_left_con_nowhr">
					</div>
					<div class="news_lefttits news_lefttitlatv" id="newPolicies">
						<ul class="news_leftlist">
						</ul>
					</div>
					<input type="hidden" id="startIndex"/>
					<div class="paging_policy paging_policyatv">
						<div id="pager" style="text-align: center;"></div>
					</div>
				</div>
                  <div class="new_right">
						<div class="newsright">
							<div class="mr-listone">相关新闻</div><div class="mr-listthr news-change" onclick="exchange()">换一换↺</div>
						<hr class="certer_left_con_nowhr">
							<ul class="news-list-v show" >
							</ul>	
						</div>	
						 <div class="index_link">
		    		<h3>友情链接</h3>
					<hr class="certer_left_con_nowhr" />
					<ul class="index_link_img">
						<li class="index_link_imgli">
							<a href="http://www.epicc.com.cn/shop/" target="_black">中国人民保险</a>
						</li>
						<li class="index_link_imgli">
							<a href="http://www.cpic.com.cn/" target="_black">太平洋保险</a>
						</li>
						<li class="index_link_imgli">
							<a href="http://www.ccic-net.com.cn/" target="_black">中国大地保险</a>
						</li>
						<li class="index_link_imgli">
							<a href="http://www.cic.cn/" target="_black">中华保险</a>
						</li>
						
					</ul>
		    	</div>
			</div>
		</div>
		</div>
		<footer></footer>
		<div class="fixed"></div>
	</body>
	<script src="/static/js/bootstrap.js" type="text/javascript"></script>
 <script>$('.news_leftlistconimg p').each(function(){
 //设置显示获取字符串的字数  这个根绝要求 看需要大概显示几行
    var maxwidth=90;   
    if($(this).text().length>maxwidth){
         //截取字符串
        $(this).text($(this).text().substring(0,maxwidth));
        //多余的用省略号显示
        $(this).html($(this).html()+'...');
    }
});
</script>
<script type="text/javascript" src="/static/js/url.js"></script>
<script type="text/javascript">
	$(".news_lefttitle").click(function() {
		$(this).addClass("news_lefttitlenow").siblings().removeClass("news_lefttitlenow");
		$(".news_lefttits").eq($(this).index()).addClass("news_lefttitlatv").siblings().removeClass("news_lefttitlatv");
		loadBusiness();
		relatedNews();
	})
	$(function(){
		loadBusiness();//政策法规和新闻
		relatedNews();//相关新闻
	})
	function loadBusiness(){
		var param={};
	    param.startIndex=$('#startIndex').val();
	    param.pageSize=3;
	    param.type=$('.news_lefttitlenow').attr('data-code');
	    $.ajax({
	        type:"get",
	        url:publicUrl+"/home/loadBusiness",
	        data: param,
	        dataType:"json",
	        success:function(dataObj){
	            if(dataObj!=null){
	                var data=dataObj.data;
	                $('.news_lefttitlatv').html('');
	                var tableData=data.pageData;
	                var num=tableData.length;
	                var str='';
	                if(num>0){
	                    $.each(tableData,function(index,val){
	                    	str+='<ul class="news_leftlist">'
	                    	str+='<li onclick="newDetails('+val.id+')">';
	                        str+='<div class="news_leftlisttime"><p>'+val.addTime+'</p></div>';
	                        str+='<div class="news_leftlistcon">';
	                        str+='	<div class="news_leftlistconimg">';
	                        str+='    <h3 title="'+val.title+'">'+val.title+'</h3>';
	                        str+='		<div class="news_leftlistconimg">';
	                        str+='			<img src="http://home.sxdeliw.com'+val.cover+'" />';
	                        str+='    		<p>'+val.content+'</p>';
	                        str+='		</div>';
	                        str+='	</div>';
	                        str+='</div>';
	                        str+='</li>';
	                        str+="</ul>"
	                    })
	                }else{
	                	if(param.type==1){
	                		str+='<div style="line-height: 250px;text-align: center;font-size: 16px;color: #787675">';
	                    	str+='暂无政策法规';
	                    	str+='</div>';
	                	}else{
	                		str+='<div style="line-height: 250px;text-align: center;font-size: 16px;color: #787675">';
	                    	str+='暂无新闻热点';
	                    	str+='</div>';
	                	}
	                	
	                }
	                $('.news_lefttitlatv').append(str);
	                //分页(如果总条数大于每页显示条数则显示分页栏)
	                $('#pager').html('');
	                if(data.totalCount>data.pageSize){
	                     layui.use(['laypage', 'layer'], function(){
	                          var laypage = layui.laypage
	                          ,layer = layui.layer;
	                            //自定义首页、尾页、上一页、下一页文本
	                          laypage.render({
	                            elem: 'pager'
	                            ,first: '首页'
	                            ,last: '尾页'
	                            ,prev: '上一页'
	                            ,next: '下一页'
	                            ,count: data.totalCount
	                            ,curr:  data.startIndex
	                            ,limit: data.pageSize
	                            ,layout:['prev', 'page','first','last', 'next', 'skip']
	                            ,jump: function(obj, first){
	                                if(!first){
	                                    $('#startIndex').val(obj.curr);
	                                    loadBusiness();
	                                }
	                            }
	                        });
	                    }) 
	                }
	            }
	        }
	    })
	}
	function relatedNews(){
		var type=$('.news_lefttitlenow').attr('data-code');
	    $.ajax({
	        type:"get",
	        url:publicUrl+"/home/selectNeweByType",
	        data: {"type":type},
	        dataType:"json",
	        success:function(dataObj){
	            if(dataObj!=null){
	                var data=dataObj.data;
	                $('.news-list-v').html('');
	                var num=data.length;
	                var str='';
	                if(num==6){
	                	$(".news-change").show();
	                }else{
	                	$(".news-change").hide();
	                }
	                if(num>0){
	                    $.each(data,function(index,val){
	                    	str+='<li>';
	                        str+='    <a onclick="newDetails('+val.id+')" title="'+val.title+'">'+val.title+'</a>';
	                        str+='</li>';
	                    })
	                }else{
	               		str+='<div style="line-height: 250px;text-align: center;font-size: 16px;color: #787675">';
	                   	str+='暂无相关新闻';
	                   	str+='</div>';
	                }
	                $('.news-list-v').append(str);
	            }
	        }
	    })
	}
	function  newDetails(newId){
		window.location.href="/static/html/newsDetails.html?id="+newId+"&type="+$('.news_lefttitlenow').attr('data-code');
	}
	function exchange(){
		relatedNews();
	}
</script>
</html>